var f=(l,m,i)=>new Promise((r,t)=>{var s=n=>{try{o(i.next(n))}catch(d){t(d)}},c=n=>{try{o(i.throw(n))}catch(d){t(d)}},o=n=>n.done?r(n.value):Promise.resolve(n.value).then(s,c);o((i=i.apply(l,m)).next())});import{Z as D,j as q,bj as F,C as u,r as p,s as _,Q as x,w as C,v as K,t as N,ax as P,R as V,M as T}from"./index.d6323a8b.js";import{s as H}from"./depart.user.api.b87ee826.js";const E=l=>D.get({url:"/sys/sysDepart/queryDepartTreeSync",params:l}),Q=l=>D.get({url:"/sys/user/queryByOrgCodeForAddressList",params:l}),U=l=>D.get({url:"/sys/position/list",params:l}),W=q({__name:"DepartLeftTree",emits:["select","rootTreeData"],setup(l,{expose:m,emit:i}){F("prefixCls");const r=u(!1),t=u([]),s=u([]),c=u([]),o=u(!1),n=u(null),d=u("");function h(){return f(this,null,function*(){try{r.value=!0,t.value=[];const e=yield E();Array.isArray(e)&&(t.value=e),s.value.length===0&&w()}finally{r.value=!1}})}h();function R(e){return f(this,null,function*(){try{const a=yield E({pid:e.dataRef.id});if(a.length==0)e.dataRef.isLeaf=!0;else if(e.dataRef.children=a,s.value.length>0){let y=[];for(let v of s.value)a.findIndex(g=>g.id===v)!==-1&&y.push(v);y.length>0&&(s.value=[...s.value])}t.value=[...t.value]}catch(a){console.error(a)}return Promise.resolve()})}function w(){let e=t.value[0];e&&(e.isLeaf||(s.value=[e.key]),L())}function L(){return f(this,null,function*(){yield T(),o.value=!0,yield T(),o.value=!1})}function k(e,a){c.value=[e],a&&(n.value=a,i("select",a))}function A(e){return f(this,null,function*(){if(e)try{r.value=!0,t.value=[];let a=yield H({keyWord:e});Array.isArray(a)&&(t.value=a),w()}finally{r.value=!1}else h();d.value=e})}function B(e,a){e.length>0&&c.value[0]!==e[0]?k(e[0],a.selectedNodes[0]):k(c.value[0])}return m({loadRootTreeData:h}),(e,a)=>{const y=p("a-input-search"),v=p("a-tree"),g=p("a-empty"),S=p("a-spin"),b=p("a-card");return _(),x(b,{bordered:!1,style:{height:"100%"}},{default:C(()=>[K(S,{spinning:r.value},{default:C(()=>[K(y,{placeholder:"\u6309\u90E8\u95E8\u540D\u79F0\u641C\u7D22\u2026",style:{"margin-bottom":"10px"},onSearch:A,allowClear:""}),t.value.length>0?(_(),N(P,{key:0},[o.value?V("",!0):(_(),x(v,{key:0,showLine:"",clickRowToExpand:!1,treeData:t.value,selectedKeys:c.value,"load-data":R,expandedKeys:s.value,"onUpdate:expandedKeys":a[0]||(a[0]=j=>s.value=j),onSelect:B},null,8,["treeData","selectedKeys","expandedKeys"]))],64)):(_(),x(g,{key:1,description:"\u6682\u65E0\u6570\u636E"}))]),_:1},8,["spinning"])]),_:1})}}});export{W as _,Q as l,U as p};

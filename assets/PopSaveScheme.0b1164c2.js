var _=(e,o,n)=>new Promise((r,c)=>{var p=a=>{try{t(n.next(a))}catch(l){c(l)}},s=a=>{try{t(n.throw(a))}catch(l){c(l)}},t=a=>a.done?r(a.value):Promise.resolve(a.value).then(p,s);t((n=n.apply(e,o)).next())});import{j as D,o as k,C as m,a7 as j,m as F,bj as y,a6 as O,ds as h,q as L,r as u,s as B,Q as I,w as i,v as d,y as S,x as N}from"./index.d6323a8b.js";import{f as A}from"./controller.api.50e8f0e1.js";const $=O.useForm,P=D({name:"PopSaveScheme",setup(){const{t:e}=k(),o=m(!1),n=m(!1),r=m([]),c=m("add"),p=m(),s=j({name:""}),t=F(()=>({name:[{type:"string",required:!0,message:e("device.tips.pleaseInputSchemeName"),trigger:"blur"}]})),{resetFields:a,validate:l,validateInfos:v}=$(s,t),b=f=>{a(),o.value=!0,r.value=f},g=()=>{o.value=!1},C=y("changeDeviceObj",{});return{visible:o,submitLoading:n,addType:c,formRef:p,validateInfos:v,formState:s,labelCol:{span:8},wrapperCol:{span:15},showModal:b,handleCancel:g,onSubmit:()=>{var f;if(!((f=C.value)!=null&&f.id))return h.warning(e("device.tips.pleaseChoseDevice"));l().then(()=>_(this,null,function*(){n.value=!0;const w={deviceId:C.value.id,name:s.name,settings:JSON.stringify(r.value)};A(w).then(()=>{h.success(e("device.tips.success")),n.value=!1,g()}).catch(()=>{n.value=!1})}))}}}});function T(e,o,n,r,c,p){const s=u("a-button"),t=u("a-input"),a=u("a-form-item"),l=u("a-form"),v=u("a-modal");return B(),I(v,{wrapClassName:"one-column-modal",title:"\u4FDD\u5B58",visible:e.visible,maskClosable:!1,confirmLoading:e.submitLoading,width:700,onOk:e.onSubmit,onCancel:e.handleCancel},{footer:i(()=>[d(s,{size:"large",onClick:e.handleCancel},{default:i(()=>[S("\u53D6\u6D88")]),_:1},8,["onClick"]),d(s,{size:"large",type:"primary",loading:e.submitLoading,onClick:e.onSubmit},{default:i(()=>[S("\u4FDD\u5B58")]),_:1},8,["loading","onClick"])]),default:i(()=>[d(l,{ref:"formRef","label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:i(()=>[d(a,N({label:"\u8BA1\u5212\u6A21\u677F\u540D\u79F0"},e.validateInfos.name,{name:"name"}),{default:i(()=>[d(t,{value:e.formState.name,"onUpdate:value":o[0]||(o[0]=b=>e.formState.name=b),maxLength:50},null,8,["value"])]),_:1},16)]),_:1},8,["label-col","wrapper-col"])]),_:1},8,["visible","confirmLoading","onOk","onCancel"])}const M=L(P,[["render",T]]);export{M as default};

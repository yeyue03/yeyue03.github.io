var m=(g,n,t)=>new Promise((y,i)=>{var d=u=>{try{l(t.next(u))}catch(f){i(f)}},o=u=>{try{l(t.throw(u))}catch(f){i(f)}},l=u=>u.done?y(u.value):Promise.resolve(u.value).then(d,o);l((t=t.apply(g,n)).next())});import{b as C,dB as E,D as B,dx as S,dE as h,C as v,a7 as T,Z as F}from"./index.d6323a8b.js";const w=g=>{const n="/sys/annountCement/vue3List";return F.get({url:n,params:g})};function P(){const g=C("rangeDate");console.log("+++++++++++++++++++++"),console.log("rangeDateArray",g),console.log("+++++++++++++++++++++");const n=v([]),t=v(1),y=10,i=T({fromUser:"",rangeDateKey:"",rangeDate:[],starFlag:""});function d(){const{fromUser:e,rangeDateKey:a,rangeDate:s,starFlag:c}=i,D={fromUser:e,starFlag:c,rangeDateKey:a,beginDate:"",endDate:"",pageNo:t.value,pageSize:y};return a=="zdy"&&(D.beginDate=s[0]+" 00:00:00",D.endDate=s[1]+" 23:59:59"),D}const o=v(!1);function l(){return m(this,null,function*(){if(o.value===!0)return;const e=d(),a=yield w(e);if(console.log("\u83B7\u53D6\u7ED3\u679C",a),!a||a.length<=0){o.value=!0;return}a.length<y&&(o.value=!0),t.value=t.value+1;const s=n.value;s.push(...a),n.value=s})}function u(){n.value=[],t.value=1,o.value=!1}function f(e){const a="/sys/sysAnnouncementSend/edit";let s="1";e.starFlag==s&&(s="0");const c={starFlag:s,id:e.sendId};F.put({url:a,params:c})}const r=v(!1);function p(){return m(this,null,function*(){r.value=!0,yield l(),r.value=!1})}function b(e){return e.readFlag!=="1"}function A(e){return e.busType=="email"?"\u90AE\u4EF6\u63D0\u9192:":e.busType=="bpm"?"\u6D41\u7A0B\u50AC\u529E:":e.busType=="bpm_task"?"\u6D41\u7A0B\u4EFB\u52A1:":e.msgCategory=="2"?"\u7CFB\u7EDF\u6D88\u606F:":e.msgCategory=="1"?"\u901A\u77E5\u516C\u544A:":""}return{messageList:n,reset:u,loadData:l,loadEndStatus:o,searchParams:i,updateStarMessage:f,onLoadMore:p,noRead:b,getMsgCategory:A}}function H(g){const n=C("messageHref"),t=E(),y=B(),i=S(),{close:d,closeSameRoute:o}=h();function l(r,p){return m(this,null,function*(){r.busType?yield u(r):p?p():yield f(r)})}function u(r){return m(this,null,function*(){const{busType:p,busId:b,msgAbstract:A}=r,e=n.filter(c=>c.value===p);if(!e||e.length==0){console.error("\u5F53\u524D\u4E1A\u52A1\u7C7B\u578B\u4E0D\u8BC6\u522B",p);return}let a=e[0].text;a=a.replace("{DETAIL_ID}",b);const s={detailId:b};if(A)try{const c=JSON.parse(A);Object.keys(c).map(D=>{s[D]=c[D]})}catch(c){console.error("msgAbstract\u53C2\u6570\u4E0D\u662FJSON\u683C\u5F0F",A)}y.setMessageHrefParams(s),i.path.indexOf(a)>=0?(yield d(),yield t.replace({path:a,query:{time:new Date().getTime()}})):(o(a),yield t.push({path:a}))})}function f(r){return m(this,null,function*(){g("detail",r)})}return{goPage:l}}export{P as a,H as u};

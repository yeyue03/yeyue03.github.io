import{U as b}from"./JUpload.vue_vue_type_style_index_0_lang.a2ed25c2.js";import"./JUploadModal.vue_vue_type_script_setup_true_lang.1a9447ac.js";var P=Object.defineProperty,x=Object.defineProperties,w=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,m=(i,e,t)=>e in i?P(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,h=(i,e)=>{for(var t in e||(e={}))F.call(e,t)&&m(i,t,e[t]);if(a)for(var t of a(e))I.call(e,t)&&m(i,t,e[t]);return i},T=(i,e)=>x(i,w(e)),d=(i,e,t)=>new Promise((s,n)=>{var l=o=>{try{c(t.next(o))}catch(p){n(p)}},u=o=>{try{c(t.throw(o))}catch(p){n(p)}},c=o=>o.done?s(o.value):Promise.resolve(o.value).then(l,u);c((t=t.apply(i,e)).next())});const ie="jeecg_submit_form_and_flow",se="flow_submit_id",re="online_form_table_name",ne="validate-failed",oe="setup",le="EnhanceJS",ue={password:"text",file:"text",image:"text",textarea:"text",umeditor:"text",markdown:"text",checkbox:"list_multi",radio:"list"},O=".jeecg-online-modal .ant-modal-content",ce="online_";class r{constructor(e,t){this._data=t,this.field=e,this.label=t.title,this.hidden=!1,this.order=t.order||999,this.required=!1,this.onlyValidator="",this.setFieldsValue="",this.hasChange=!0,e.indexOf("@")>0?this.pre=e.substring(0,e.indexOf("@")+1):this.pre="",this.schemaProp={},this.searchForm=!1,this.disabled=!1,this.popContainer="",this.handleWidgetAttr(t),this.inPopover=!1}getFormItemSchema(){let e=this.getItem();return this.addDefaultChangeEvent(e),e}getItem(){let e={field:this.field,label:this.label,labelLength:4,component:"Input",itemProps:{labelCol:{class:"online-form-label"}}},t=this.getRule();return t.length>0&&this.onlyValidator&&(e.rules=t),this.hidden===!0&&(e.show=!1),e}setFormRef(e){this.formRef=e}isHidden(){return this.hidden=!0,this}isRequired(e){return e&&e.length>0&&e.indexOf(this.field)>=0&&(this.required=!0),this}getExtendData(){let e={},{fieldExtendJson:t}=this._data;if(t&&typeof t=="string")try{let s=JSON.parse(t);e=h({},s)}catch(s){console.error(s)}return e}getRelatedHideFields(){return[]}getPlaceholder(){return"\u8BF7\u8F93\u5165"+this.label}setOnlyValidateFun(e){e&&(this.onlyValidator=(t,s)=>d(this,null,function*(){let n=yield e(t,s);return n?Promise.reject(n):Promise.resolve()}))}getRule(){let e=[];const{view:t,errorInfo:s,pattern:n,type:l}=this._data;if(this.required===!0){let u=this.getPlaceholder();s&&(u=s),t=="sel_depart"||t=="sel_user"?this.schemaProp.required=!0:e.push({required:!0,message:u})}if(t=="sel_user"&&n==="only"&&this.onlyValidator&&e.push({validator:this.onlyValidator}),t==="list"||t==="radio"||t==="markdown"||t==="pca"||t.indexOf("sel")>=0||t==="time"||t.indexOf("upload")>=0||t.indexOf("file")>=0||t.indexOf("image")>=0)return e;if(n)if(n==="only")this.onlyValidator&&e.push({validator:this.onlyValidator});else if(n==="z")l=="number"||l=="integer"||e.push({pattern:/^-?\d+$/,message:"\u8BF7\u8F93\u5165\u6574\u6570"});else{let u=s||"\u6B63\u5219\u8868\u8FBE\u5F0F\u4E0D\u6B63\u786E";e.push({pattern:n,message:u})}return e}addDefaultChangeEvent(e){this.hasChange&&(e.componentProps||(e.componentProps={}),this.disabled==!0&&(e.componentProps.disabled=!0),e.componentProps.hasOwnProperty("onChange")||(e.componentProps.onChange=(t,s)=>{t instanceof Event&&(t=t.target.value),t instanceof Array&&(t=t.join(",")),!this.formRef||!this.formRef.value||!this.formRef.value.$formValueChange?console.log("\u5F53\u524D\u8868\u5355\u65E0\u6CD5\u89E6\u53D1change\u4E8B\u4EF6,field\uFF1A"+this.field):this.formRef.value.$formValueChange(this.field,t,s)})),Object.keys(this.schemaProp).map(t=>{e[t]=this.schemaProp[t]})}noChange(){this.hasChange=!1}updateField(e){this.field=e}setFunctionForFieldValue(e){e&&(this.setFieldsValue=e)}asSearchForm(){this.searchForm=!0}getModalAsContainer(){let e=this.getPopContainer();return document.querySelector(e)}getPopContainer(){return this.searchForm===!0?"body":this.inPopover===!0?`.${this.popContainer}`:this.popContainer?`.${this.popContainer} .ant-modal-content`:O}handleWidgetAttr(e){e.ui&&e.ui.widgetattrs&&e.ui.widgetattrs.disabled==!0&&(this.disabled=!0)}setCustomPopContainer(e){this.popContainer=e}getLinkFieldInfo(){return""}setOtherInfo(e){}isInPopover(){this.inPopover=!0}}class g extends r{getItem(){let e=super.getItem();return this.hidden===!0&&(e.show=!1),e}}var C=(i=>(i.datetime="YYYY-MM-DD HH:mm:ss",i.date="YYYY-MM-DD",i))(C||{});class _ extends r{constructor(e,t){super(e,t),this.format=C[t.view],this.showTime=t.view!="date"}getItem(){let e=super.getItem();return Object.assign({},e,{component:"DatePicker",componentProps:{placeholder:`\u8BF7\u9009\u62E9${this.label}`,showTime:this.showTime,valueFormat:this.format,style:{width:"100%"},getPopupContainer:t=>this.getModalAsContainer()}})}}class S extends r{constructor(e,t){super(e,t),this.options=this.getOptions(t.enum),this.dictTable=t.dictTable,this.dictText=t.dictText,this.dictCode=t.dictCode,this.multi=t.multi||!1}getItem(){let e=super.getItem(),t=this.getFormComponent(),s=this.getComponentProps();return Object.assign({},e,{component:t,componentProps:s})}getFormComponent(){return this.options.length>0?"Select":"JDictSelectTag"}getComponentProps(){let t={allowClear:!0,mode:this.multi===!0?"multiple":"combobox",style:{width:"100%"},getPopupContainer:s=>this.getModalAsContainer()};if(this.options.length>0)t.options=this.options;else if(!this.dictTable)t.dictCode=this.dictCode;else{let s=`${this.dictTable},${this.dictText},${this.dictCode}`;t.dictCode=encodeURI(s)}return t}getOptions(e){if(!e||e.length==0)return[];let t=[];for(let s of e)t.push({value:s.value,label:s.title});return t}}class v extends r{getItem(){let e=super.getItem();return Object.assign({},e,{component:"InputPassword"})}}class E extends r{getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JUpload",componentProps:t})}getComponentProps(){let e=this.getExtendData();return e&&e.uploadnum?{maxCount:Number(e.uploadnum)}:{}}}class j extends r{getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JUpload",componentProps:t})}getComponentProps(){let e={fileType:b.image},t=this.getExtendData();return t&&t.uploadnum&&(e.maxCount=Number(t.uploadnum)),e}}class D extends r{getItem(){let e=super.getItem();return Object.assign({},e,{component:"InputTextArea"})}}class R extends r{constructor(e,t){super(e,t),this.dictTable=t.dictTable,this.dictText=t.dictText,this.dictCode=t.dictCode}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JSelectMultiple",componentProps:t})}getComponentProps(){if(!this.dictTable&&!this.dictCode)return{};{let e={};if(!this.dictTable)e.dictCode=this.dictCode;else{let t=`${this.dictTable},${this.dictText},${this.dictCode}`;e.dictCode=encodeURI(t)}return e.triggerChange=!0,e.popContainer=this.getPopContainer(),e}}}class W extends r{constructor(e,t){super(e,t),this.dict=encodeURI(`${t.dictTable},${t.dictText},${t.dictCode}`)}getItem(){let e=super.getItem(),t=this.getPopContainer();return Object.assign({},e,{component:"JSearchSelect",componentProps:{dict:this.dict,pageSize:6,async:!0,popContainer:t}})}}class y extends r{constructor(e,t){super(e,t),this.code=t.code,this.multi=t.popupMulti,this.fieldConfig=this.getFieldConfig(t)}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JPopup",componentProps:t})}getComponentProps(){let e={code:this.code,multi:this.multi,fieldConfig:this.fieldConfig};return this.formRef?e.formElRef=this.formRef:e.setFieldsValue=this.setFieldsValue,this.inPopover===!0&&(e.getContainer=()=>this.getModalAsContainer()),e}getFieldConfig(e){let{destFields:t,orgFields:s}=e;if(!t||t.length==0)return[];let n=t.split(","),l=s.split(","),u=[];const c=this.pre;for(let o=0;o<n.length;o++)u.push({target:c+n[o],source:l[o]});return u}}class V extends r{constructor(e,t){super(e,t),this.multi=!1,this.pid=t.pidValue,this.pcode=t.pcode,this.textField=t.textField}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{componentProps:t,component:"JCategorySelect"})}getComponentProps(){let e={placeholder:"\u8BF7\u9009\u62E9"+this.label};if(this.pcode)e.pcode=this.pcode;else{let t=this.pid||"EMPTY_PID";e.pid=t}return this.textField?T(h({loadTriggleChange:!0,multiple:this.multi},e),{back:this.textField,onChange:(t,s)=>{this.formRef&&(this.formRef.value.setFieldsValue(s),this.formRef.value.$formValueChange(this.field,t))}}):h({multiple:this.multi},e)}getRelatedHideFields(){let e=[];return this.textField&&e.push(this.textField),e}}class A extends r{getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JSelectDept",componentProps:t})}getComponentProps(){let e=this.getExtendData(),t={checkStrictly:!0,showButton:!1};return e.text&&(t.labelKey=e.text),e.store&&(t.rowKey=e.store),e.multiSelect===!1&&(t.multiple=!1),this.inPopover===!0&&(t.getContainer=()=>this.getModalAsContainer()),t}}class M extends r{constructor(e,t){super(e,t),this.showButton=t.showButton!==!1}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JSelectUser",componentProps:t})}getComponentProps(){let e=this.getExtendData(),t={showSelected:!1,allowClear:!0,isRadioSelection:!1,showButton:this.showButton};return e.text&&(t.labelKey=e.text),e.store&&(t.rowKey=e.store),e.multiSelect===!1&&(t.isRadioSelection=!0),this.inPopover===!0&&(t.getContainer=()=>this.getModalAsContainer()),t}}class N extends r{getItem(){let e=super.getItem();return Object.assign({},e,{component:"JEditor",componentProps:{options:{auto_focus:!1}}})}}class J extends r{getItem(){let e=super.getItem();return Object.assign({},e,{component:"JMarkdownEditor",componentProps:{}})}}class $ extends r{getItem(){let e=super.getItem();return Object.assign({},e,{component:"JAreaSelect"})}}class L extends r{constructor(e,t){super(e,t),this.dict=t.dict,this.pidField=t.pidField,this.pidValue=t.pidValue}getItem(){let e=super.getItem();return Object.assign({},e,{component:"JTreeSelect",componentProps:{dict:this.dict,pidField:this.pidField,pidValue:this.pidValue}})}}class B extends r{constructor(e,t){super(e,t),this.dictTable=t.dictTable,this.dictText=t.dictText,this.dictCode=t.dictCode}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JDictSelectTag",componentProps:t})}getComponentProps(){if(!this.dictTable&&!this.dictCode)return{};if(this.dictTable){let e=`${this.dictTable},${this.dictText},${this.dictCode}`;return{dictCode:encodeURI(e),type:"radio"}}else return{dictCode:this.dictCode,type:"radio"}}}class U extends r{constructor(e,t){super(e,t),this.options=this.getOptions(t.enum)}getItem(){let e=super.getItem();return Object.assign({},e,{component:"JCheckbox",componentProps:{options:this.options,triggerChange:!0}})}getOptions(e){if(!e||e.length==0)return[];let t=[];for(let s of e)t.push({value:s.value,label:s.title});return t}}class Y extends r{constructor(e,t){super(e,t),this.hasChange=!1}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JSwitch",componentProps:t})}getComponentProps(){let{fieldExtendJson:e}=this._data,t=["Y","N"];if(e&&typeof e=="string"){let s=JSON.parse(e);s.length==2&&(t=s)}return{options:t}}}class q extends r{getItem(){let e=super.getItem();return Object.assign({},e,{component:"TimePicker",componentProps:{placeholder:`\u8BF7\u9009\u62E9${this.label}`,valueFormat:"HH:mm:ss",getPopupContainer:t=>this.getModalAsContainer(),style:{width:"100%"}}})}}class H extends r{constructor(e,t){super(e,t);const{dictTable:s,dictText:n,dictCode:l,pidField:u,idField:c,origin:o,condition:p}=t;this.table=s,this.txt=n,this.store=l,this.idField=c,this.pidField=u,this.origin=o,this.condition=p,this.options=[],this.next=t.next||"",this.type=t.type}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"OnlineSelectCascade",componentProps:t})}getComponentProps(){let e={table:this.table,txt:this.txt,store:this.store,pidField:this.pidField,idField:this.idField,origin:this.origin,pidValue:"-1",style:{width:"100%"},onChange:t=>{console.log("\u7EA7\u8054\u7EC4\u4EF6-onChange",t),this.valueChange(t)},onNext:t=>{console.log("\u7EA7\u8054\u7EC4\u4EF6-onNext",t),this.nextOptionsChange(t)}};return this._data.origin===!0&&(e.condition=this.condition),e}nextOptionsChange(e){return d(this,null,function*(){if(!this.formRef){console.error("\u8868\u5355\u5F15\u7528\u627E\u4E0D\u5230");return}if(!this.next)return;yield this.formRef.value.updateSchema({field:this.next,componentProps:{pidValue:e}})})}valueChange(e){return d(this,null,function*(){if(!this.formRef){console.error("\u8868\u5355\u5F15\u7528\u627E\u4E0D\u5230");return}if(!this.next)return;let t=this.formRef.value;t.$formValueChange(this.field,e),yield t.setFieldsValue({[this.next]:""})})}}class f extends r{constructor(e,t){super(e,t),this.slot=""}getItem(){let e=super.getItem(),t=this.slot;return Object.assign({},e,{slot:t})}groupDate(){return this.slot="groupDate",this}groupDatetime(){return this.slot="groupDatetime",this}groupNumber(){return this.slot="groupNumber",this}}class Q extends r{constructor(e,t){super(e,t),this.dbPointLength=t.dbPointLength}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"InputNumber",componentProps:t})}getComponentProps(){const e={style:{width:"100%"}};return this.dbPointLength>=0&&(e.precision=this.dbPointLength),e}}class K extends r{constructor(e,t){super(e,t),this.dictTable=t.dictTable,this.dictText=t.dictText,this.dictCode=t.dictCode,this.view=t.view,this.componentString="",this.linkFields=[]}getItem(){let e=super.getItem();const t=this.getComponentProps();return Object.assign({},e,{component:this.componentString,componentProps:t})}getComponentProps(){let e={textField:this.dictText,tableName:this.dictTable,valueField:this.dictCode},t=this.getExtendData();if(t.multiSelect?e.multi=!0:e.multi=!1,t.imageField?e.imageField=t.imageField:e.imageField="",t.showType=="select"){this.componentString="LinkTableSelect";let s=this.getPopContainer();e.popContainer=s}else this.componentString="LinkTableCard";return this.linkFields.length>0&&(e.linkFields=this.linkFields),e}setOtherInfo(e){this.linkFields=e}}class z extends r{constructor(e,t){super(e,t),this.dictTable=t.dictTable,this.dictText=t.dictText}getItem(){let e=super.getItem();return Object.assign({},e,{componentProps:{readOnly:!0,allowClear:!1,disabled:!0,style:{background:"none",color:"rgba(0, 0, 0, 0.85)",border:"none"}}})}getLinkFieldInfo(){return[this.dictTable,`${this.field},${this.dictText}`]}}class G extends r{constructor(e,t){super(e,t),this.code=t.code,this.titleField=t.titleField,this.multi=t.multi||!1}getItem(){let e=super.getItem();return Object.assign({},e,{component:"LinkTableForQuery",componentProps:{code:this.code,multi:this.multi,field:this.titleField,style:{width:"100%"}}})}}class X extends r{getItem(){let e=super.getItem();return Object.assign({},e,{component:"CascaderPcaForQuery",componentProps:{style:{width:"100%"}}})}}class Z extends r{constructor(e,t){super(e,t),this.multi=t.multi===!0,this.store=t.store||"",this.query=t.query||!1}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"UserSelect",componentProps:t})}getComponentProps(){let e={multi:this.multi,store:this.store,query:this.query};return this.inPopover===!0&&(e.getContainer=()=>this.getModalAsContainer()),e}}class k extends r{constructor(e,t){super(e,t);let s=t.view;this.datetime=!1,s==="rangeNumber"?this.componentType="JRangeNumber":(this.componentType="RangeDate",t.datetime===!0&&(this.datetime=!0))}getItem(){let e=super.getItem();return Object.assign({},e,{component:this.componentType,componentProps:{datetime:this.datetime,getPopupContainer:t=>this.getModalAsContainer()}})}}class pe{static createFormSchema(e,t){switch(t.view){case"password":return new v(e,t);case"list":return new S(e,t);case"radio":return new B(e,t);case"checkbox":return new U(e,t);case"date":case"datetime":return new _(e,t);case"time":return new q(e,t);case"file":return new E(e,t);case"image":return new j(e,t);case"textarea":return new D(e,t);case"list_multi":return new R(e,t);case"sel_search":return new W(e,t);case"popup":return new y(e,t);case"cat_tree":return new V(e,t);case"sel_depart":return new A(e,t);case"sel_user":return new M(e,t);case"umeditor":return new N(e,t);case"markdown":return new J(e,t);case"pca":return new $(e,t);case"link_down":return new H(e,t);case"sel_tree":return new L(e,t);case"switch":return new Y(e,t);case"link_table":return new K(e,t);case"link_table_field":return new z(e,t);case"slot":return new f(e,t);case"LinkTableForQuery":return new G(e,t);case"CascaderPcaForQuery":return new X(e,t);case"select_user2":return new Z(e,t);case"rangeDate":case"rangeNumber":return new k(e,t);case"hidden":return new g(e,t).isHidden();default:return t.type=="number"?new Q(e,t):new g(e,t)}}static createSlotFormSchema(e,t){let s=new f(e,t),n=t.view;if(n=="date")s.groupDate();else if(n=="datetime")s.groupDatetime();else{let l=t.type;(l=="number"||l=="integer")&&s.groupNumber()}return s}static createIdField(){return{label:"",field:"id",component:"Input",show:!1}}}export{le as E,pe as F,re as O,ie as S,ne as V,ce as a,se as b,ue as c,oe as d};

var W=Object.defineProperty;var D=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var v=(o,t,s)=>t in o?W(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s,B=(o,t)=>{for(var s in t||(t={}))E.call(t,s)&&v(o,s,t[s]);if(D)for(var s of D(t))R.call(t,s)&&v(o,s,t[s]);return o};var w=(o,t,s)=>new Promise((d,i)=>{var u=a=>{try{p(s.next(a))}catch(l){i(l)}},m=a=>{try{p(s.throw(a))}catch(l){i(l)}},p=a=>a.done?d(a.value):Promise.resolve(a.value).then(u,m);p((s=s.apply(o,t)).next())});import{u as S,B as T}from"./useForm.c448380d.js";import"./componentMap.fc77c2dc.js";import{j as k,dF as x,C as _,m as I,H as r,s as L,Q as V,w as j,v as M,x as N}from"./index.d6323a8b.js";import{f as O,l as $,C as q,g as G}from"./menu.data.46f84dcd.js";import{u as H,B as Q}from"./index.30a7fa2c.js";import{useDrawerAdaptiveWidth as z}from"./useAdaptiveWidth.ec4c3ae5.js";const oe=k({__name:"MenuDrawer",emits:["success","register"],setup(o,{emit:t}){const{adaptiveWidth:s}=z(),d=x(),i=_(!0),u=_(0),m=e=>e===2,[p,{setProps:a,resetFields:l,setFieldsValue:g,updateSchema:F,validate:y,clearValidate:J}]=S({labelCol:{md:{span:4},sm:{span:6}},wrapperCol:{md:{span:20},sm:{span:18}},schemas:O,showActionButtonGroup:!1}),[b,{setDrawerProps:h,closeDrawer:A}]=H(e=>w(this,null,function*(){var n;yield l(),h({confirmLoading:!1}),i.value=!!(e!=null&&e.isUpdate),u.value=(n=e==null?void 0:e.record)==null?void 0:n.menuType;const c=yield $();if(F([{field:"parentId",componentProps:{treeData:c}},{field:"name",label:m(r(u))?"\u6309\u94AE/\u6743\u9650":"\u83DC\u5355\u540D\u79F0"},{field:"url",required:!m(r(u)),componentProps:{onChange:f=>C(f.target.value)}}]),typeof e.record=="object"){let f=B({},e.record);g(f),C(f.url)}a({disabled:!d.showFooter})})),P=I(()=>r(i)?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355");function U(){return w(this,null,function*(){try{const e=yield y();q.IFrame===e.component&&(e.component=e.frameSrc),h({confirmLoading:!0}),yield G(e,r(i)),A(),t("success")}finally{h({confirmLoading:!1})}})}function C(e){let c="",n=e;e!=null&&e!=""?(e.startsWith("/")&&(e=e.substring(1)),e=e.replaceAll("/","-"),e=e.replaceAll(":","@"),c=`${e}`):c="\u8BF7\u8F93\u5165\u7EC4\u4EF6\u540D\u79F0",F([{field:"componentName",componentProps:{placeholder:c}}]),n!=null&&n!=""&&(n.startsWith("http://")||n.startsWith("https://"))&&g({component:n})}return(e,c)=>(L(),V(r(Q),N(e.$attrs,{onRegister:r(b),showFooter:"",width:r(s),title:r(P),onOk:U}),{default:j(()=>[M(r(T),{onRegister:r(p),class:"menuForm"},null,8,["onRegister"])]),_:1},16,["onRegister","width","title"]))}});export{oe as _};

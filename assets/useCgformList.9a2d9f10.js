import{dB as Fe,aO as me,bI as f,C as B,h as m,eA as he,bu as T,aB as be,H as ye,b0 as Ee,bU as De,E as Be,u as ge}from"./index.d6323a8b.js";import"./index.d82ed84a.js";import{a as Ce}from"./index.30a7fa2c.js";import{useListPage as we}from"./useListPage.148819a1.js";import{l as ve,d as _e,a as M,b as S,c as Te,e as Me}from"./CgformModal.b3f609c0.js";import{C as L}from"./clipboard.9b0741ac.js";var Se=Object.defineProperty,Le=Object.defineProperties,Ae=Object.getOwnPropertyDescriptors,A=Object.getOwnPropertySymbols,Pe=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable,P=(u,t,a)=>t in u?Se(u,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):u[t]=a,g=(u,t)=>{for(var a in t||(t={}))Pe.call(t,a)&&P(u,a,t[a]);if(A)for(var a of A(t))ke.call(t,a)&&P(u,a,t[a]);return u},C=(u,t)=>Le(u,Ae(t)),w=(u,t,a)=>new Promise((d,F)=>{var o=s=>{try{c(a.next(s))}catch(i){F(i)}},p=s=>{try{c(a.throw(s))}catch(i){F(i)}},c=s=>s.done?d(s.value):Promise.resolve(s.value).then(o,p);c((a=a.apply(u,t)).next())}),O=(u=>(u[u.normal=0]="normal",u[u.copy=1]="copy",u))(O||{});const v="copy-this-text",k="data-clipboard-text";function Oe(){return{createCopyModal:Ue}}const{createMessage:E,createConfirm:xe}=ge();function Ue(u){var t,a,d,F,o;const p=ye(u.copyText),c=`INSERT INTO sys_permission(id, parent_id, name, url, component, component_name, redirect, menu_type, perms, perms_type, sort_no, always_show, icon, is_route, is_leaf, keep_alive, hidden, hide_tab, description, status, del_flag, rule_flag, create_by, create_time, update_by, update_time, internal_or_external) 
                       VALUES ('${Ee()}', NULL, '${u.copyTitle}', '${p}', '1', NULL, NULL, 0, NULL, '1', 0.00, 0, NULL, 0, 1, 0, 0, 0, NULL, '1', 0, 0, 'admin', null, NULL, NULL, 0)`;let s=xe(C(g({},u),{iconType:(t=u.iconType)!=null?t:"info",width:(a=u.width)!=null?a:500,title:(d=u.title)!=null?d:"\u590D\u5236",closable:!0,maskClosable:(F=u.maskClosable)!=null?F:!0,cancelText:"\u590D\u5236SQL",okText:(o=u.okText)!=null?o:"\u590D\u5236URL",cancelButtonProps:{class:"copy-this-sql","data-clipboard-text":c},okButtonProps:C(g({},u.okButtonProps),{class:v,[k]:p}),onOk(){return new Promise(i=>{const l=new L("."+v);l.on("success",()=>{l.destroy(),E.success("\u590D\u5236URL\u6210\u529F"),i()}),l.on("error",()=>{E.error("\u8BE5\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u81EA\u52A8\u590D\u5236"),l.destroy(),i()})})},onCancel(){return new Promise(i=>{const l=new L(".copy-this-sql");l.on("success",()=>{l.destroy(),E.success("\u590D\u5236\u63D2\u5165\u83DC\u5355SQL\u6210\u529F"),i()}),l.on("error",()=>{E.error("\u8BE5\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u81EA\u52A8\u590D\u5236"),l.destroy(),i()})})}}));return De(u.copyText)&&Be(u.copyText,i=>{s.update({okButtonProps:C(g({},u.okButtonProps),{class:v,[k]:i})})}),s}function qe(u){const t=u.pageType===O.normal,a=Fe(),d=we({designScope:u.designScope,tableProps:{api:ve,columns:u.columns,formConfig:{schemas:u.formSchemas},beforeFetch:e=>{let n=t?0:1,r=t?void 0:a.currentRoute.value.params.code;return me(e.tableType_MultiString)&&(e.tableType_MultiString=e.tableType_MultiString.join(",")),Object.assign(e,{copyType:n,physicId:r})}}}),{tableContext:F,createMessage:o,createConfirm:p}=d,[,{reload:c,setLoading:s},{selectedRowKeys:i,selectedRows:l}]=F,[x,_]=f(),[U,N]=f(),[$,I]=f(),[R,j]=f(),[Y,q]=f(),[J,G]=f(),[V,Q]=f(),[H,K]=Ce(),[X,z]=f();function W(){_.openModal(!0,{isUpdate:!1})}function Z(e){_.openModal(!0,{isUpdate:!0,record:e})}function ee(){let e=i.value;if(e.length<=0){o.warning("\u8BF7\u5148\u9009\u62E9\u4E00\u6761\u8BB0\u5F55\uFF01");return}p({title:"\u5220\u9664",content:"<p>\u79FB\u9664\u53EA\u4F1A\u5220\u9664\u8868\u5355\u914D\u7F6E\uFF1B<br>\u5220\u9664\u5219\u4F1A\u5220\u9664\u5BF9\u5E94\u7684\u6570\u636E\u5E93\u8868\u4EE5\u53CA\u5B50\u8868\u4E14\u4E0D\u80FD\u6062\u590D\u3002<br>\u8BF7\u786E\u8BA4\u60A8\u7684\u64CD\u4F5C\u2026</p>",iconType:"warning",closable:!0,okText:"\u79FB\u9664",cancelText:"\u5220\u9664",cancelButtonProps:{danger:!0},onOk:()=>w(this,null,function*(){return h(M,e,!0)}),onCancel(n){return n!=null&&n.triggerCancel?Promise.resolve():h(S,e,!0)}})}function h(e,n,r=!1){return w(this,null,function*(){try{s(!0);const D=yield e(n);return c(),r&&(i.value=[]),D}finally{s(!1)}return Promise.reject()})}function ue(){b(([e])=>j.openModal(!0,{row:e}))}function te(){b(([e])=>q.openModal(!0,{row:e}))}function ne(){b(([e])=>G.openModal(!0,{row:e}))}function ae(){b(([e])=>Q.openModal(!0,{row:e}))}function oe(){N.openModal(!0,{})}function b(e,n=1,r=1){l.value.length<n?o.warning(`\u8BF7\u5148\u81F3\u5C11\u9009\u4E2D ${n} \u6761\u8BB0\u5F55`):l.value.length>r?o.warning(`\u6700\u591A\u53EA\u80FD\u9009\u4E2D ${n} \u6761\u8BB0\u5F55`):e(l.value)}function le(){if(l.value.length===0)o.warning("\u8BF7\u5148\u9009\u4E2D\u4E00\u6761\u8BB0\u5F55");else if(l.value.length>1)o.warning("\u4EE3\u7801\u751F\u6210\u53EA\u80FD\u9009\u4E2D\u4E00\u6761\u8BB0\u5F55");else{let e=l.value[0];e?e.isDbSynch!="Y"?o.warning("\u8BF7\u5148\u540C\u6B65\u6570\u636E\u5E93\uFF01"):e.tableType==3?o.warning("\u8BF7\u9009\u4E2D\u8BE5\u8868\u5BF9\u5E94\u7684\u4E3B\u8868"):I.openModal(!0,{code:e.id}):o.warning("\u8BF7\u9009\u4E2D\u5F53\u524D\u9875\u7684\u6570\u636E\uFF01")}}function se(e){console.log(e),e.isTree=="Y"?a.push({path:"/online/cgformTreeList/"+e.id}):a.push({path:"/online/cgformList/"+e.id})}function ie(e){const n=B("normal"),r=B(!1),D=p({iconType:"info",title:"\u540C\u6B65\u6570\u636E\u5E93",content:()=>m("div",{style:"margin: 20px 0;"},m(he,{value:n.value,disabled:r.value,"onUpdate:value":y=>n.value=y},()=>[m(T,{value:"normal"},()=>"\u666E\u901A\u540C\u6B65\uFF08\u4FDD\u7559\u8868\u6570\u636E\uFF09"),m(T,{value:"force"},()=>"\u5F3A\u5236\u540C\u6B65\uFF08\u5220\u9664\u8868\uFF0C\u91CD\u65B0\u751F\u6210\uFF09")])),maskClosable:!0,okText:"\u5F00\u59CB\u540C\u6B65",onOk(){return w(this,null,function*(){r.value=!0,D.update({maskClosable:!1,keyboard:!1,okText:"\u540C\u6B65\u4E2D\u2026",okButtonProps:{loading:r.value},cancelButtonProps:{disabled:r.value}});try{yield Te(e.id,n.value)}catch(y){o.warn(y.message||y)}finally{c()}})}})}const{createCopyModal:re}=Oe();function ce(e){let n;e.themeTemplate==="erp"?n=`/online/cgformErpList/${e.id}`:e.themeTemplate==="innerTable"?n=`/online/cgformInnerTableList/${e.id}`:e.themeTemplate==="tab"?n=`/online/cgformTabList/${e.id}`:e.isTree=="Y"?n=`/online/cgformTreeList/${e.id}`:n=`/online/cgformList/${e.id}`,re({title:`\u83DC\u5355\u94FE\u63A5\u3010${e.tableTxt}\u3011`,content:n,copyText:n,copyTitle:`${e.tableTxt}`})}function pe(e){const n=B(e.tableName+"_copy");p({title:"\u590D\u5236\u8868",content:()=>m("div",{style:"margin: 20px 0;"},["\u8BF7\u8F93\u5165\u65B0\u8868\u540D\uFF1A",m(be,{value:n.value,"onUpdate:value":r=>n.value=r})]),iconType:"info",closable:!0,okText:"\u590D\u5236",onOk(){n.value?n.value===e.tableName?o.warning("\u65B0\u8868\u540D\u548C\u65E7\u8868\u540D\u4E0D\u80FD\u4E00\u81F4"):Me(e.id,n.value).then(c):o.warning("\u8BF7\u8F93\u5165\u65B0\u8868\u540D")}})}function fe(e){return[{label:"\u7F16\u8F91",onClick:()=>Z(e)}]}function de(e){return[{label:"\u540C\u6B65\u6570\u636E\u5E93",onClick:()=>ie(e),ifShow:()=>t&&e.isDbSynch!="Y"},{label:"\u529F\u80FD\u6D4B\u8BD5",class:["low-app-hide"],onClick:()=>se(e),ifShow:()=>t?e.isDbSynch=="Y"&&e.tableType!==3:!0},{label:"\u914D\u7F6E\u5730\u5740",class:["low-app-hide"],onClick:()=>ce(e),ifShow:()=>t?e.isDbSynch=="Y"&&e.tableType!==3:!0},{label:"\u6743\u9650\u63A7\u5236",onClick:()=>K.openDrawer(!0,{cgformId:e.id})},{label:"\u89D2\u8272\u6388\u6743",onClick:()=>z.openModal(!0,{cgformId:e.id})},{label:"\u89C6\u56FE\u7BA1\u7406",class:["low-app-hide"],onClick:()=>a.push(`/online/copyform/${e.id}`),ifShow:()=>t&&e.hascopy==1},{label:"\u751F\u6210\u89C6\u56FE",class:["low-app-hide"],popConfirm:{title:"\u786E\u5B9A\u751F\u6210\u89C6\u56FE\u5417\uFF1F",placement:"left",confirm:()=>{s(!0),_e(e.id).then(()=>{o.success("\u5DF2\u6210\u529F\u751F\u6210\u89C6\u56FE")}).finally(()=>{s(!1),c()})}},ifShow:()=>t},{label:"\u590D\u5236\u8868",onClick:()=>pe(e),ifShow:()=>t},{label:"\u79FB\u9664",popConfirm:{title:"\u786E\u5B9A\u79FB\u9664\u5417\uFF1F",placement:"left",confirm:()=>h(M,[e.id])}},{label:"\u5220\u9664",popConfirm:{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",placement:"left",confirm:()=>h(S,[e.id])},ifShow:()=>t}]}return{router:a,pageContext:d,onAdd:W,onDeleteBatch:ee,onImportDbTable:oe,onGenerateCode:le,onShowCustomButton:ue,onShowEnhanceJs:te,onShowEnhanceSql:ne,onShowEnhanceJava:ae,getTableAction:fe,getDropDownAction:de,registerCustomButtonModal:R,registerEnhanceJsModal:Y,registerEnhanceSqlModal:J,registerEnhanceJavaModal:V,registerAuthManagerDrawer:H,registerAuthSetterModal:X,registerCgformModal:x,registerDbToOnlineModal:U,registerCodeGeneratorModal:$}}export{O as C,qe as u};

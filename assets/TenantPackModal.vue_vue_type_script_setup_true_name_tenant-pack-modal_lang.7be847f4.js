var q=Object.defineProperty,z=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var y=(s,n,t)=>n in s?q(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,E=(s,n)=>{for(var t in n||(n={}))J.call(n,t)&&y(s,t,n[t]);if(_)for(var t of _(n))W.call(n,t)&&y(s,t,n[t]);return s},A=(s,n)=>z(s,G(n));var u=(s,n,t)=>new Promise((m,p)=>{var C=o=>{try{f(t.next(o))}catch(c){p(c)}},i=o=>{try{f(t.throw(o))}catch(c){p(c)}},f=o=>o.done?m(o.value):Promise.resolve(o.value).then(C,i);f((t=t.apply(s,n)).next())});import{B as X}from"./index.d82ed84a.js";import{b as Y,c as Z,d as ee,h as F}from"./tenant.api.12483c43.js";import{useListPage as te}from"./useListPage.148819a1.js";import ne from"./BasicTable.0a886d20.js";import{T as ae}from"./componentMap.fc77c2dc.js";import"./BasicTable.vue_vue_type_style_index_0_lang.fd294b48.js";import"./useTable.2733e6a7.js";import{_ as se}from"./TenantPackMenuModal.vue_vue_type_script_setup_true_name_tenant-pack-menu-modal_lang.6412d5ad.js";import{j as R,bI as w,C as M,H as a,bH as oe,a7 as ue,r as ie,s as D,t as le,v as l,w as d,y as P,Q as ce,R as re,x as de,ax as me,a2 as pe,u as fe}from"./index.d6323a8b.js";import ge from"./TenantPackUserModal.1959f0d9.js";const Ce=R({name:"tenant-pack-modal"}),De=R(A(E({},Ce),{emits:["register","success"],setup(s,{emit:n}){const[t,{openModal:m}]=w(),[p,{openModal:C}]=w(),i=M(0),{prefixCls:f,tableContext:o}=te({designScope:"tenant-template",tableProps:{api:Y,columns:Z,immediate:!1,formConfig:{schemas:ee,labelCol:{xxl:8},actionColOptions:{xs:24,sm:8,md:8,lg:8,xl:8,xxl:8}},beforeFetch:e=>Object.assign(e,{tenantId:a(i)})}}),[c,{reload:v},{rowSelection:T,selectedRowKeys:k,selectedRows:I}]=o,B=M(""),[O,{setModalProps:ke,closeModal:S}]=oe(e=>u(this,null,function*(){i.value=e.tenantId,B.value=e.createBy,r()})),U="\u79DF\u6237\u4EA7\u54C1\u5305\u5217\u8868";function j(e){return u(this,null,function*(){S()})}function N(e){return[{label:"\u7528\u6237",onClick:K.bind(null,e)},{label:"\u7F16\u8F91",onClick:V.bind(null,e)},{label:"\u5220\u9664",popConfirm:{title:"\u662F\u5426\u786E\u8BA4\u5220\u9664\u79DF\u6237\u4EA7\u54C1\u5305",confirm:H.bind(null,e)}}]}function r(){(k.value=[])&&v()}function V(e){return u(this,null,function*(){m(!0,{isUpdate:!0,record:e,tenantId:a(i)})})}const b=ue(["superAdmin","accountAdmin","appAdmin"]),{createMessage:h}=fe();function H(e){return u(this,null,function*(){if(b.indexOf(e.packCode)!=-1){h.warning("\u9ED8\u8BA4\u7CFB\u7EDF\u4EA7\u54C1\u5305\u4E0D\u5141\u8BB8\u5220\u9664");return}yield F({ids:e.id},r)})}function L(){return u(this,null,function*(){let e=I.value;if(e&&e.length>0){for(let g=0;g<e.length;g++)if(b.indexOf(e[g].packCode)!=-1){h.warning("\u9ED8\u8BA4\u7CFB\u7EDF\u4EA7\u54C1\u5305\u4E0D\u5141\u8BB8\u5220\u9664");return}}pe.confirm({title:"\u5220\u9664\u79DF\u6237\u4EA7\u54C1\u5305",content:"\u662F\u5426\u5220\u9664\u79DF\u6237\u4EA7\u54C1\u5305",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:()=>u(this,null,function*(){yield F({ids:k.value.join(",")},r)})})})}function $(){m(!0,{isUpdate:!1,tenantId:a(i)})}function K(e){e.createBy=a(B),C(!0,{record:e})}return(e,g)=>{const x=ie("a-button");return D(),le(me,null,[l(a(X),de(e.$attrs,{onRegister:a(O),title:U,onOk:j,width:"800px",showCancelBtn:!1,showOkBtn:!1}),{default:d(()=>[l(a(ne),{onRegister:a(c),rowSelection:a(T)},{tableTitle:d(()=>[l(x,{preIcon:"ant-design:plus-outlined",type:"primary",onClick:$,style:{"margin-right":"5px"}},{default:d(()=>[P("\u65B0\u589E ")]),_:1}),a(k).length>0?(D(),ce(x,{key:0,preIcon:"ant-design:delete-outlined",type:"primary",onClick:L,style:{"margin-right":"5px"}},{default:d(()=>[P("\u6279\u91CF\u5220\u9664 ")]),_:1})):re("",!0)]),action:d(({record:Q})=>[l(a(ae),{actions:N(Q)},null,8,["actions"])]),_:1},8,["onRegister","rowSelection"])]),_:1},16,["onRegister"]),l(se,{onRegister:a(t),onSuccess:r},null,8,["onRegister"]),l(ge,{onRegister:a(p),onSuccess:r},null,8,["onRegister"])],64)}}}));export{De as _};

import y from"./DeviceItem.33bccaab.js";import C from"./InfoPopup.8116ab08.js";import{g as R,a as $}from"./controller.api.50e8f0e1.js";import{j as B,o as H,dx as V,C as f,a7 as j,a as N,ds as O,q as S,r as P,s as r,t as h,aW as m,ax as b,bc as x,v as g,w as T,d3 as q,N as F,O as z,V as A}from"./index.d6323a8b.js";const E=B({name:"ChartSideBar",components:{DeviceItem:y,InfoPopup:C},emits:["selectDevice"],setup(i,{emit:v}){const{t:I}=H(),_=V(),n=f(!1),p=j({id:1,name:"HPP 260"}),s=f([]),d=f(0),t=f(),u=()=>{s.value=[],R().then(e=>{var c;if(e&&e.length){const o=(c=_.query)==null?void 0:c.id;let a=null;for(const l of e)l.url=N(l.url),l.isLink&&!a&&(a=l),o&&o==l.id&&(a=l);a&&(Object.assign(p,a),v("selectDevice",a))}s.value=e||[],k()})};u();const L=e=>{const c={deviceId:e.id};$(c).then(o=>{e.temperature=(o==null?void 0:o.temperature)||0,e.humidity=(o==null?void 0:o.humidity)||0,e.beam=(o==null?void 0:o.beam)||0,e.setTemperature=(o==null?void 0:o.setTemperature)||0,e.setHumidity=(o==null?void 0:o.setHumidity)||0,e.setBeam=(o==null?void 0:o.setBeam)||0})},k=()=>{const e=s.value;if(e&&e.length)for(const c of e)L(c)},w=e=>{if(!e.isLink)return O.warning(I("device.tips.deviceNotLink"));Object.assign(p,e),v("selectDevice",e)};let D=-1;return{visibleInfo:n,infoPopTop:d,infoPopRef:t,deviceList:s,activeDeviceObj:p,initDeviceList:u,clickDevice:w,showInfoPopup:e=>{D==e.id?n.value?n.value=!1:(t.value.showInfoPopup(e),n.value=!0):(D=e.id,n.value=!0,t.value.showInfoPopup(e))},hideInfoPopup:()=>{n.value=!1}}}});const M={class:"scheme-box"},U=["onClick"],W=["onClick"];function G(i,v,I,_,n,p){const s=P("DeviceItem"),d=P("InfoPopup");return r(),h(b,null,[m("div",M,[(r(!0),h(b,null,x(i.deviceList,t=>(r(),h("div",{key:t.id,onClick:u=>i.clickDevice(t)},[g(s,{infoItem:t,activeDeviceId:i.activeDeviceObj.id},{default:T(()=>[m("i",{class:"iconfont icon-xinxiinfo21 icon-help",onClick:q(u=>i.showInfoPopup(t),["stop"])},null,8,W)]),_:2},1032,["infoItem","activeDeviceId"])],8,U))),128))]),F(m("div",{class:"info-popup",style:A(`top: ${i.infoPopTop}px`)},[g(d,{ref:"infoPopRef",onHideInfoPopup:i.hideInfoPopup,onRefreshList:i.initDeviceList},null,8,["onHideInfoPopup","onRefreshList"])],4),[[z,i.visibleInfo]])],64)}const ee=S(E,[["render",G],["__scopeId","data-v-710bc234"]]);export{ee as default};

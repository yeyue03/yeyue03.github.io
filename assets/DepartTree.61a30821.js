var h=(m,f,r)=>new Promise((l,n)=>{var p=t=>{try{i(r.next(t))}catch(u){n(u)}},c=t=>{try{i(r.throw(t))}catch(u){n(u)}},i=t=>t.done?l(t.value):Promise.resolve(t.value).then(p,c);i((r=r.apply(m,f)).next())});import{j as K,bj as S,C as o,r as E,s as d,t as x,v as M,w as N,H as s,ax as P,Q as g,R as b,M as k,u as j,q as F}from"./index.d6323a8b.js";import{_ as R}from"./index.e9877282.js";import{l as q,s as I}from"./depart.user.api.b87ee826.js";import"./bem.40e6f864.js";import"./props.5cd8551a.js";import"./useContextMenu.d4034b7b.js";const L={class:"bg-white m-4 mr-0 overflow-hidden"},V=K({__name:"DepartTree",emits:["select"],setup(m,{emit:f}){S("prefixCls");const{createMessage:r}=j();let l=o(!1),n=o([]),p=o([]),c=o([]),i=o(!0),t=o("2"),u=o(!1);function v(){l.value=!0,n.value=[],q().then(e=>{e.success?Array.isArray(e.result)&&(n.value=e.result,t.value=e.message,w()):r.warning(e.message)}).finally(()=>l.value=!1)}v();function w(){let e=[];n.value.forEach((a,y)=>{a.children&&a.children.length>0&&e.push(a.key),y===0&&_(a.id,a)}),e.length>0&&(D(),p.value=e)}function D(){return h(this,null,function*(){yield k(),u.value=!0,yield k(),u.value=!1})}function _(e,a){c.value=[e],a&&f("select",a)}function T(e){e?(l.value=!0,I({keyWord:e,myDeptSearch:"1"}).then(a=>{Array.isArray(a)?n.value=a:(r.warning("\u672A\u67E5\u8BE2\u5230\u90E8\u95E8\u4FE1\u606F"),n.value=[])}).finally(()=>l.value=!1)):v()}function A(e,a){e.length>0&&c.value[0]!==e[0]?_(e[0],a.selectedNodes[0]):_(c.value[0])}function B(e){p.value=e,i.value=!1}return(e,a)=>{const y=E("a-empty"),C=E("a-spin");return d(),x("div",L,[M(C,{spinning:s(l)},{default:N(()=>[s(t)==="2"?(d(),x(P,{key:0},[s(u)?b("",!0):(d(),g(s(R),{key:0,title:"\u90E8\u95E8\u5217\u8868",toolbar:"",search:"",showLine:"",checkStrictly:!0,clickRowToExpand:!1,treeData:s(n),selectedKeys:s(c),expandedKeys:s(p),autoExpandParent:s(i),onSelect:A,onExpand:B,onSearch:T},null,8,["treeData","selectedKeys","expandedKeys","autoExpandParent"]))],64)):(d(),g(y,{key:1,description:"\u666E\u901A\u5458\u5DE5\u65E0\u6B64\u6743\u9650"}))]),_:1},8,["spinning"])])}}});const O=F(V,[["__scopeId","data-v-0cfa4334"]]);export{O as default};

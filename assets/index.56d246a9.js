var ge=Object.defineProperty;var te=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var ne=(t,n,s)=>n in t?ge(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,K=(t,n)=>{for(var s in n||(n={}))ye.call(n,s)&&ne(t,s,n[s]);if(te)for(var s of te(n))he.call(n,s)&&ne(t,s,n[s]);return t};var D=(t,n,s)=>new Promise((e,a)=>{var U=d=>{try{f(s.next(d))}catch(g){a(g)}},m=d=>{try{f(s.throw(d))}catch(g){a(g)}},f=d=>d.done?e(d.value):Promise.resolve(d.value).then(U,m);f((s=s.apply(t,n)).next())});import{v as u,av as J,m as M,a7 as ve,a9 as Se,a as ce,ab as Q,q as j,r as i,s as _,Q as w,w as S,aW as C,V as E,z as N,aJ as ie,t as T,R as A,C as x,E as W,Z as F,cM as Ue,cN as xe,bH as Le,cO as be,y as se,ax as q,bc as V,B as H,j as Ce,b$ as Oe,a6 as we,bI as Ie}from"./index.d6323a8b.js";import{B as ke}from"./index.d82ed84a.js";var Te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h368c4.4 0 8 3.6 8 8v48z"}}]},name:"minus-circle",theme:"filled"};const De=Te;function le(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?Object(arguments[n]):{},e=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),e.forEach(function(a){Me(t,a,s[a])})}return t}function Me(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}var Z=function(n,s){var e=le({},n,s.attrs);return u(J,le({},e,{icon:De}),null)};Z.displayName="MinusCircleFilled";Z.inheritAttrs=!1;const Pe=Z;var ze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M483.2 790.3L861.4 412c1.7-1.7 2.5-4 2.3-6.3l-25.5-301.4c-.7-7.8-6.8-13.9-14.6-14.6L522.2 64.3c-2.3-.2-4.7.6-6.3 2.3L137.7 444.8a8.03 8.03 0 000 11.3l334.2 334.2c3.1 3.2 8.2 3.2 11.3 0zm62.6-651.7l224.6 19 19 224.6L477.5 694 233.9 450.5l311.9-311.9zm60.16 186.23a48 48 0 1067.88-67.89 48 48 0 10-67.88 67.89zM889.7 539.8l-39.6-39.5a8.03 8.03 0 00-11.3 0l-362 361.3-237.6-237a8.03 8.03 0 00-11.3 0l-39.6 39.5a8.03 8.03 0 000 11.3l243.2 242.8 39.6 39.5c3.1 3.1 8.2 3.1 11.3 0l407.3-406.6c3.1-3.1 3.1-8.2 0-11.3z"}}]},name:"tags",theme:"outlined"};const Ae=ze;function ae(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?Object(arguments[n]):{},e=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),e.forEach(function(a){Be(t,a,s[a])})}return t}function Be(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}var G=function(n,s){var e=ae({},n,s.attrs);return u(J,ae({},e,{icon:Ae}),null)};G.displayName="TagsOutlined";G.inheritAttrs=!1;const Re=G;var Ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"};const Fe=Ee;function oe(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?Object(arguments[n]):{},e=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),e.forEach(function(a){je(t,a,s[a])})}return t}function je(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}var X=function(n,s){var e=oe({},n,s.attrs);return u(J,oe({},e,{icon:Fe}),null)};X.displayName="TeamOutlined";X.inheritAttrs=!1;const Ne=X;var Ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"};const He=Ke;function re(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?Object(arguments[n]):{},e=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),e.forEach(function(a){qe(t,a,s[a])})}return t}function qe(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}var Y=function(n,s){var e=re({},n,s.attrs);return u(J,re({},e,{icon:He}),null)};Y.displayName="UserOutlined";Y.inheritAttrs=!1;const de=Y,Ve={name:"UserList",components:{UserOutlined:de},props:{dataList:{type:Array,default:()=>[]},depart:{type:Boolean,default:!1},selectedIdList:{type:Array,default:()=>[]},excludeUserIdList:{type:Array,default:()=>[]}},emits:["selected","unSelect"],setup(t,{emit:n}){function s(o,v){o&&d(o),f[v.id]===!0?n("unSelect",v.id):n("selected",Q(v))}function e(o){return o?o.substr(0,2):""}const a=M(()=>t.depart===!0?{flex:1}:{display:"none"}),U=M(()=>t.depart===!0?{width:"200px"}:{flex:1});function m(o){console.error("onChangeChecked",o)}const f=ve({});Se(()=>{let o=t.dataList;if(!o||o.length===0)return;let v=t.selectedIdList;for(let y of o)v.indexOf(y.id)>=0?f[y.id]=!0:f[y.id]=!1});function d(o){o.preventDefault(),o.stopPropagation()}function g(){let o=[],v=t.excludeUserIdList,y=t.dataList;if(y&&y.length>0)for(let L of y)v.indexOf(L.id)<0&&o.push(K({},L));return o}const h=M(()=>{let o=t.excludeUserIdList;return o&&o.length>0?g():t.dataList});return{onClickUser:s,getTwoText:e,departStyle:a,nameStyle:U,onChangeChecked:m,checkStatus:f,showDataList:h,getFileAccessHttpUrl:ce}}};const Je=["onClick"];function Qe(t,n,s,e,a,U){const m=i("a-checkbox"),f=i("a-avatar"),d=i("UserOutlined"),g=i("a-list-item"),h=i("a-list");return _(),w(h,{"item-layout":"horizontal","data-source":e.showDataList},{renderItem:S(({item:o})=>[u(g,{style:{padding:"3px 0"}},{default:S(()=>[C("div",{class:"user-select-user-info",onClick:v=>e.onClickUser(v,o)},[C("div",null,[u(m,{checked:e.checkStatus[o.id],"onUpdate:checked":v=>e.checkStatus[o.id]=v},null,8,["checked","onUpdate:checked"])]),C("div",null,[o.avatar?(_(),w(f,{key:0,src:e.getFileAccessHttpUrl(o.avatar)},null,8,["src"])):(_(),w(f,{key:1},{icon:S(()=>[u(d)]),_:1}))]),C("div",{style:E(e.nameStyle)},N(o.realname),5),C("div",{style:E(e.departStyle)},N(o.orgCodeTxt),5)],8,Je)]),_:2},1024)]),_:1},8,["data-source"])}const $=j(Ve,[["render",Qe]]);const We={name:"SelectedUserItem",components:{UserOutlined:de,MinusCircleFilled:Pe,CloseOutlined:ie,TagsOutlined:Re,TeamOutlined:Ne},props:{info:{type:Object,default:()=>{}},query:{type:Boolean,default:!1}},emits:["unSelect"],setup(t,{emit:n}){function s(a){a.preventDefault(),a.stopPropagation(),n("unSelect",t.info.id)}return{showClose:M(()=>t.query===!0),removeSelect:s,getFileAccessHttpUrl:ce}}},Ze={class:"user-selected-item"},Ge={style:{display:"flex","flex-direction":"row",height:"24px","border-radius":"12px","padding-right":"10px","vertical-align":"middle","background-color":"#f5f5f5"}},Xe={style:{width:"24px",height:"24px","line-height":"20px","margin-right":"3px",display:"inline-block"}},Ye={style:{height:"24px","line-height":"24px"},class:"ellipsis"},$e={key:0,class:"icon-close"},et={key:0,class:"icon-remove"};function tt(t,n,s,e,a,U){const m=i("a-avatar"),f=i("team-outlined"),d=i("TagsOutlined"),g=i("UserOutlined"),h=i("CloseOutlined"),o=i("MinusCircleFilled");return _(),T("div",Ze,[C("div",Ge,[C("span",Xe,[s.info.avatar?(_(),w(m,{key:0,src:e.getFileAccessHttpUrl(s.info.avatar),size:24},null,8,["src"])):s.info.selectType=="sys_role"?(_(),w(m,{key:1,size:24,style:{"background-color":"rgb(255, 173, 0)"}},{icon:S(()=>[u(f,{style:{"font-size":"16px"}})]),_:1})):s.info.selectType=="sys_position"?(_(),w(m,{key:2,size:24,style:{"background-color":"rgb(245, 34, 45)"}},{icon:S(()=>[u(d,{style:{"font-size":"16px"}})]),_:1})):(_(),w(m,{key:3,size:24},{icon:S(()=>[u(g)]),_:1}))]),C("div",Ye,N(s.info.realname||s.info.name),1),e.showClose?(_(),T("div",$e,[u(h,{onClick:e.removeSelect},null,8,["onClick"])])):A("",!0)]),e.showClose?A("",!0):(_(),T("div",et,[u(o,{onClick:e.removeSelect},null,8,["onClick"])]))])}const ue=j(We,[["render",tt]]),nt={name:"DepartUserList",components:{UserList:$},props:{searchText:{type:String,default:""},selectedIdList:{type:Array,default:()=>[]},excludeUserIdList:{type:Array,default:()=>[]}},emits:["loaded","selected","unSelect"],setup(t,{emit:n}){function s(l){return D(this,null,function*(){const c="/sys/sysDepart/queryDepartTreeSync";let r={};l&&(r.pid=l);const b=yield F.get({url:c,params:r},{isTransformResponse:!1});return console.log("loadDepartTree",b),b})}function e(){return D(this,null,function*(){console.log("initRoot");const l=yield s();if(l.success){let c=l.result;U.value=c,a(c)}else console.error(l.message);h()})}function a(l){let c=[];l&&l.length>0&&(c=l.map(r=>({value:r.id,label:r.departName}))),n("loaded",c)}e();const U=x([]),m=x([]),f=x([]),d=x("");function g(l,c){let r=c.node.dataRef;m.value=[r.key];let b=l[0];d.value=b,O()}function h(){d.value=""}function o(l){return D(this,null,function*(){console.log("loadChildren",l);const c=yield s(l.eventKey);if(c.success){let r=c.result;l.dataRef.children=[...r],U.value=[...U.value]}else console.error(c.message)})}const v=x(300);v.value=window.innerHeight-300;const y=M(()=>({"overflow-y":"auto","max-height":v.value+"px"})),L=x([]);function O(){return D(this,null,function*(){const l="/sys/user/selectUserList";let c={pageNo:1,pageSize:10};t.searchText&&(c.keyword=t.searchText),d.value&&(c.departId=d.value);const r=yield F.get({url:l,params:c},{isTransformResponse:!1});if(r.success){const{records:b}=r.result;L.value=b}else console.error(r.message);console.log("depart-loadUserList",r)})}W(()=>t.searchText,()=>{O()});function k(l){n("selected",l)}function P(l){n("unSelect",l)}return{containerStyle:y,treeData:U,selectedKeys:m,expandedKeys:f,onSelect:g,loadChildren:o,onSelectUser:k,unSelectUser:P,userDataList:L}}};function st(t,n,s,e,a,U){const m=i("a-tree"),f=i("a-col"),d=i("user-list"),g=i("a-row");return _(),w(g,null,{default:S(()=>[u(f,{span:12},{default:S(()=>[C("div",{style:E(e.containerStyle)},[e.treeData.length>0?(_(),w(m,{key:0,"load-data":e.loadChildren,showIcon:"",autoExpandParent:"",treeData:e.treeData,selectedKeys:e.selectedKeys,expandedKeys:e.expandedKeys,"onUpdate:expandedKeys":n[0]||(n[0]=h=>e.expandedKeys=h),onSelect:e.onSelect},null,8,["load-data","treeData","selectedKeys","expandedKeys","onSelect"])):A("",!0)],4)]),_:1}),u(f,{span:12,style:{"padding-left":"10px"}},{default:S(()=>[C("div",{style:E(e.containerStyle)},[u(d,{excludeUserIdList:s.excludeUserIdList,dataList:e.userDataList,selectedIdList:s.selectedIdList,onSelected:e.onSelectUser,onUnSelect:e.unSelectUser},null,8,["excludeUserIdList","dataList","selectedIdList","onSelected","onUnSelect"])],4)]),_:1})]),_:1})}const lt=j(nt,[["render",st]]),at={name:"RoleUserList",components:{UserList:$},props:{searchText:{type:String,default:""},selectedIdList:{type:Array,default:()=>[]},excludeUserIdList:{type:Array,default:()=>[]}},emits:["selected","unSelect"],setup(t,{emit:n}){const s=x([]);function e(){return D(this,null,function*(){const y="/sys/role/listByTenant";let L={order:"desc",column:"createTime",pageSize:200},O=[];const k=yield F.get({url:y,params:L},{isTransformResponse:!1});if(k.success){const{records:P}=k.result;O=P.map(l=>({title:l.roleName,id:l.id,key:l.id}))}console.log("loadRoleList",k),s.value=O})}e();const a=x([]),U=x("");function m(y,L){let O=L.node.dataRef;a.value=[O.key];let k=y[0];U.value=k,d()}const f=x([]);function d(){return D(this,null,function*(){const y="/sys/user/selectUserList";let L={pageNo:1,pageSize:10};t.searchText&&(L.keyword=t.searchText),U.value&&(L.roleId=U.value);const O=yield F.get({url:y,params:L},{isTransformResponse:!1});if(O.success){const{records:k}=O.result;f.value=k}else console.error(O.message);console.log("role-loadUserList",O)})}W(()=>t.searchText,()=>{d()});function g(y){n("selected",y)}function h(y){n("unSelect",y)}const o=x(300);return o.value=window.innerHeight-300,{containerStyle:M(()=>({"overflow-y":"auto","max-height":o.value+"px"})),treeData:s,selectedKeys:a,onSelect:m,onSelectUser:g,unSelectUser:h,userDataList:f}}};function ot(t,n,s,e,a,U){const m=i("a-tree"),f=i("a-col"),d=i("user-list"),g=i("a-row");return _(),w(g,null,{default:S(()=>[u(f,{span:12},{default:S(()=>[C("div",{style:E(e.containerStyle)},[e.treeData.length>0?(_(),w(m,{key:0,showIcon:"",treeData:e.treeData,selectedKeys:e.selectedKeys,onSelect:e.onSelect},null,8,["treeData","selectedKeys","onSelect"])):A("",!0)],4)]),_:1}),u(f,{span:12,style:{"padding-left":"10px"}},{default:S(()=>[C("div",{style:E(e.containerStyle)},[u(d,{excludeUserIdList:s.excludeUserIdList,dataList:e.userDataList,selectedIdList:s.selectedIdList,onSelected:e.onSelectUser,onUnSelect:e.unSelectUser},null,8,["excludeUserIdList","dataList","selectedIdList","onSelected","onUnSelect"])],4)]),_:1})]),_:1})}const rt=j(at,[["render",ot]]),ct=be,it={name:"UserSelectModal",components:{BasicModal:ke,SearchOutlined:Ue,CloseOutlined:ie,SelectedUserItem:ue,UserList:$,DepartUserList:lt,RoleUserList:rt,APagination:ct},props:{multi:{type:Boolean,default:!1},getContainer:{type:Function,default:null},izExcludeMy:{type:Boolean,default:!1}},emits:["selected","register"],setup(t,{emit:n}){const s=x("1"),e=x([]),a=xe(),U=M(()=>{let p=e.value;return!p||p.length==0?[]:p.map(I=>I.id)}),m=x([]),[f]=Le(p=>{let I=p.list;I&&I.length>0?e.value=[...I]:e.value=[],p.excludeUserIdList?m.value=p.excludeUserIdList:m.value=[],t.izExcludeMy&&m.value.push(a.getUserInfo.id)});function d(){let p=Q(e.value);n("selected",p)}const g=x(""),h=x([]);function o(p){h.value=[{value:"",label:"\u5168\u90E8\u7528\u6237"},...p],g.value=""}function v(){B()}const y=x(!1),L=x("");function O(p){p&&ee(p),y.value=!0}function k(){console.log("onSearchUser"),B()}function P(p){p&&ee(p),L.value="",y.value=!1,B()}const l=x(1),c=x(0),r=x([]);function b(){return D(this,null,function*(){console.log("onPageChange",l.value),yield B()})}function B(){return D(this,null,function*(){const p="/sys/user/selectUserList";let I={pageNo:l.value,pageSize:10};L.value&&(I.keyword=L.value),g.value&&(I.departId=g.value);const z=yield F.get({url:p,params:I},{isTransformResponse:!1});if(z.success){const{records:R,total:_e}=z.result;c.value=_e,r.value=R}else console.error(z.message);console.log("loadUserList",z)})}function fe(p){if(t.multi===!0){let I=e.value;U.value.indexOf(p.id)<0&&(I.push(K({},p)),e.value=I)}else e.value=[K({},p)]}function me(p){let I=e.value,z=-1;for(let R=0;R<I.length;R++)if(I[R].id===p){z=R;break}z>=0&&(I.splice(z,1),e.value=I)}function pe(p){s.value=p}function ee(p){p.preventDefault(),p.stopPropagation()}return B(),{selectedDepart:g,departOptions:h,initDepartOptions:o,onDepartChange:v,register:f,handleOk:d,searchText:L,searchInputStatus:y,showSearchInput:O,onSearchUser:k,clearSearch:P,myActiveKey:s,onChangeTab:pe,pageNo:l,totalRecord:c,onPageChange:b,userDataList:r,selectedUserList:e,selectedIdList:U,onSelectUser:fe,unSelectUser:me,excludeUserIdList:m}}};const dt={style:{position:"relative","min-height":"350px"}},ut={class:"my-tabs"},ft={class:"selected-users",style:{width:"100%","overflow-x":"hidden"}},mt={style:{display:"flex","justify-content":"space-between",width:"100%"}},pt={class:"select-user-page-info"};function _t(t,n,s,e,a,U){const m=i("a-select-option"),f=i("a-select"),d=i("SearchOutlined"),g=i("CloseOutlined"),h=i("a-input"),o=i("user-list"),v=i("a-tab-pane"),y=i("depart-user-list"),L=i("role-user-list"),O=i("a-tabs"),k=i("SelectedUserItem"),P=i("a-pagination"),l=i("a-button"),c=i("BasicModal");return _(),w(c,{onRegister:e.register,getContainer:s.getContainer,canFullscreen:!1,title:"\u9009\u62E9\u7528\u6237",width:600,wrapClassName:"j-user-select-modal2"},{footer:S(()=>[C("div",mt,[C("div",pt,[e.myActiveKey=="1"?(_(),w(P,{key:0,current:e.pageNo,"onUpdate:current":n[3]||(n[3]=r=>e.pageNo=r),size:"small",total:e.totalRecord,"show-quick-jumper":"",onChange:e.onPageChange},null,8,["current","total","onChange"])):A("",!0)]),u(l,{type:"primary",onClick:e.handleOk},{default:S(()=>[se("\u786E \u5B9A")]),_:1},8,["onClick"])])]),default:S(()=>[u(f,{value:e.selectedDepart,"onUpdate:value":n[0]||(n[0]=r=>e.selectedDepart=r),style:{width:"100%"},class:"depart-select",onChange:e.onDepartChange},{default:S(()=>[(_(!0),T(q,null,V(e.departOptions,r=>(_(),w(m,{value:r.value},{default:S(()=>[se(N(r.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value","onChange"]),C("div",dt,[C("div",{class:H(e.searchInputStatus?"my-search all-width":"my-search")},[C("span",{class:H(e.searchInputStatus?"hidden":""),style:{"margin-left":"10px"}},[u(d,{style:{color:"#c0c0c0"},onClick:e.showSearchInput},null,8,["onClick"])],2),C("div",{style:{width:"100%"},class:H(e.searchInputStatus?"":"hidden")},[u(h,{value:e.searchText,"onUpdate:value":n[1]||(n[1]=r=>e.searchText=r),onPressEnter:e.onSearchUser,style:{width:"100%"},placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u6309\u56DE\u8F66\u641C\u7D22"},{prefix:S(()=>[u(d,{style:{color:"#c0c0c0"}})]),suffix:S(()=>[u(g,{title:"\u9000\u51FA\u641C\u7D22",onClick:e.clearSearch},null,8,["onClick"])]),_:1},8,["value","onPressEnter"])],2)],2),C("div",ut,[u(O,{activeKey:e.myActiveKey,"onUpdate:activeKey":n[2]||(n[2]=r=>e.myActiveKey=r),centered:!0,onChange:e.onChangeTab},{default:S(()=>[u(v,{key:"1",tab:"\u5168\u90E8",forceRender:""},{default:S(()=>[u(o,{excludeUserIdList:e.excludeUserIdList,dataList:e.userDataList,selectedIdList:e.selectedIdList,depart:"",onSelected:e.onSelectUser,onUnSelect:e.unSelectUser},null,8,["excludeUserIdList","dataList","selectedIdList","onSelected","onUnSelect"])]),_:1}),u(v,{key:"2",tab:"\u6309\u90E8\u95E8",forceRender:""},{default:S(()=>[u(y,{searchText:e.searchText,selectedIdList:e.selectedIdList,excludeUserIdList:e.excludeUserIdList,onLoaded:e.initDepartOptions,onSelected:e.onSelectUser,onUnSelect:e.unSelectUser},null,8,["searchText","selectedIdList","excludeUserIdList","onLoaded","onSelected","onUnSelect"])]),_:1}),u(v,{key:"3",tab:"\u6309\u89D2\u8272",forceRender:""},{default:S(()=>[u(L,{excludeUserIdList:e.excludeUserIdList,searchText:e.searchText,selectedIdList:e.selectedIdList,onSelected:e.onSelectUser,onUnSelect:e.unSelectUser},null,8,["excludeUserIdList","searchText","selectedIdList","onSelected","onUnSelect"])]),_:1})]),_:1},8,["activeKey","onChange"])]),C("div",ft,[(_(!0),T(q,null,V(e.selectedUserList,r=>(_(),w(k,{info:r,onUnSelect:e.unSelectUser},null,8,["info","onUnSelect"]))),256))])])]),_:1},8,["onRegister","getContainer"])}const gt=j(it,[["render",_t]]),yt=Ce({name:"UserSelect",components:{PlusOutlined:Oe,UserSelectModal:gt,SelectedUserItem:ue},props:{store:{type:String,default:"id"},value:{type:String,default:""},multi:{type:Boolean,default:!1},getContainer:{type:Function,default:null},query:{type:Boolean,default:!1},maxCount:{type:Number,default:2},disabled:{type:Boolean,default:!1},izExcludeMy:{type:Boolean,default:!1}},emits:["update:value","change"],setup(t,{emit:n}){const s=we.useInjectFormItemContext(),e=x(!0),a=x([]),U=M(()=>{let l=a.value,c=t.maxCount;return l.length<=c?l:l.filter((r,b)=>b<c)}),m=M(()=>{let l=t.maxCount,c=a.value.length;return c>l?{status:!0,count:c-l}:{status:!1}}),[f,{openModal:d,closeModal:g}]=Ie();function h(){if(t.disabled===!0)return;let l=Q(a.value);d(!0,{list:l})}function o(l){console.log("onSelected",l),a.value=l,v(),g()}function v(){e.value=!1;let l=[],c=a.value;c&&c.length>0&&(l=c.map(b=>b[t.store]));let r=l.join(",");n("update:value",r),n("change",r),s.onFieldChange(),console.log("\u9009\u4E2D\u6570\u636E",r)}W(()=>t.value,l=>D(this,null,function*(){l?e.value===!0&&(yield y(l)):a.value=[],e.value=!0}),{immediate:!0});function y(l){return D(this,null,function*(){const c="/sys/user/list";let r={[t.store]:l};a.value=[];const b=yield F.get({url:c,params:r},{isTransformResponse:!1});if(b.success){const{records:B}=b.result;a.value=B}else console.error(b.message);console.log("getUserList",b)})}const L=M(()=>t.disabled===!0?!1:t.multi===!0?!0:!(a.value.length>0));function O(l){console.log("unSelectUser",l);let c=a.value,r=-1;for(let b=0;b<c.length;b++)if(c[b].id==l){r=b;break}r>=0&&(c.splice(r,1),a.value=c,v())}function k(l){l.preventDefault(),l.stopPropagation(),h()}const P=M(()=>t.query===!0);return{registerModal:f,onShowModal:h,isSearchFormComp:P,onSelected:o,showAddButton:L,unSelectUser:O,selectedUserList:a,showUserList:U,ellipsisInfo:m,click2Add:k}}});const ht={key:1,style:{height:"30px","line-height":"30px",display:"inline-block","margin-left":"7px",color:"#bfbfbf"}},vt={key:2,class:"user-selected-item"},St={class:"user-select-ellipsis"},Ut={style:{color:"red"}},xt={key:1,style:{display:"flex","flex-wrap":"wrap","flex-direction":"row"}};function Lt(t,n,s,e,a,U){const m=i("SelectedUserItem"),f=i("PlusOutlined"),d=i("a-button"),g=i("user-select-modal");return _(),T("div",null,[t.isSearchFormComp?(_(),T("div",{key:0,onClick:n[0]||(n[0]=(...h)=>t.click2Add&&t.click2Add(...h)),class:H(t.disabled?"disabled-user-select":""),style:{padding:"0 5px","background-color":"#fff",border:"1px solid #ccc","border-radius":"3px","box-sizing":"border-box",display:"flex",color:"#9e9e9e","font-size":"14px","flex-wrap":"wrap","min-height":"32px"}},[t.selectedUserList.length>0?(_(!0),T(q,{key:0},V(t.showUserList,h=>(_(),w(m,{info:h,onUnSelect:t.unSelectUser,query:""},null,8,["info","onUnSelect"]))),256)):(_(),T("span",ht,"\u8BF7\u9009\u62E9\u7528\u6237")),t.ellipsisInfo.status?(_(),T("div",vt,[C("div",St,[C("span",Ut,"+"+N(t.ellipsisInfo.count)+"...",1)])])):A("",!0)],2)):(_(),T("div",xt,[t.selectedUserList.length>0?(_(!0),T(q,{key:0},V(t.selectedUserList,h=>(_(),w(m,{info:h,onUnSelect:t.unSelectUser},null,8,["info","onUnSelect"]))),256)):A("",!0),t.showAddButton?(_(),w(d,{key:1,shape:"circle",onClick:t.onShowModal},{default:S(()=>[u(f)]),_:1},8,["onClick"])):A("",!0)])),u(g,{multi:t.multi,getContainer:t.getContainer,onRegister:t.registerModal,onSelected:t.onSelected,izExcludeMy:t.izExcludeMy},null,8,["multi","getContainer","onRegister","onSelected","izExcludeMy"])])}const wt=j(yt,[["render",Lt],["__scopeId","data-v-0e2989fe"]]);export{Pe as M,wt as U,gt as a};
